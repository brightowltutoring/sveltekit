import{D as xe}from"./chunks/prod-ssr.js";import{b as T,a as L,r as kt,p as Ee,o as jt,g as vt,s as xt}from"./chunks/internal.js";import{H as D,j as me,t as P,R as I,e as _e,A as we}from"./chunks/index.js";import{r as Et,w as Oe}from"./chunks/index2.js";import{parse as Q,serialize as Me}from"cookie";function ge(e,t){const r=[];e.split(",").forEach((o,i)=>{const f=/([^/]+)\/([^;]+)(?:;q=([0-9.]+))?/.exec(o);if(f){const[,d,a,u="1"]=f;r.push({type:d,subtype:a,q:+u,i})}}),r.sort((o,i)=>o.q!==i.q?i.q-o.q:o.subtype==="*"!=(i.subtype==="*")?o.subtype==="*"?1:-1:o.type==="*"!=(i.type==="*")?o.type==="*"?1:-1:o.i-i.i);let n,s=1/0;for(const o of t){const[i,f]=o.split("/"),d=r.findIndex(a=>(a.type===i||a.type==="*")&&(a.subtype===f||a.subtype==="*"));d!==-1&&d<s&&(n=o,s=d)}return n}function Ot(e,...t){const r=e.headers.get("content-type")?.split(";",1)[0].trim()??"";return t.includes(r)}function Je(e){return Ot(e,"application/x-www-form-urlencoded","multipart/form-data")}function St(e){return e instanceof Error||e&&e.name&&e.message?e:new Error(JSON.stringify(e))}function Rt(e,t){return P(`${t} method not allowed`,{status:405,headers:{allow:At(e).join(", ")}})}function At(e){const t=[];for(const r in["GET","POST","PUT","PATCH","DELETE","OPTIONS"])r in e&&t.push(r);return(e.GET||e.HEAD)&&t.push("HEAD"),t}function $e(e,t,r){let n=e.templates.error({status:t,message:r});return P(n,{headers:{"content-type":"text/html; charset=utf-8"},status:t})}async function Se(e,t,r){r=r instanceof D?r:St(r);const n=r instanceof D?r.status:500,s=await C(e,t,r),o=ge(e.request.headers.get("accept")||"text/html",["application/json","text/html"]);return e.isDataRequest||o==="application/json"?me(s,{status:n}):$e(t,n,s.message)}async function C(e,t,r){return r instanceof D?r.body:await t.hooks.handleError({error:r,event:e})??{message:e.route.id!=null?"Internal Error":"Not Found"}}function re(e,t){return new Response(void 0,{status:e,headers:{location:t}})}function Fe(e,t){return t.path?`Data returned from \`load\` while rendering ${e.route.id} is not serializable: ${t.message} (data${t.path})`:t.path===""?`Data returned from \`load\` while rendering ${e.route.id} is not a plain object`:t.message}function Be(e){const t=[];return e.uses&&e.uses.dependencies.size>0&&t.push(`"dependencies":${JSON.stringify(Array.from(e.uses.dependencies))}`),e.uses&&e.uses.params.size>0&&t.push(`"params":${JSON.stringify(Array.from(e.uses.params))}`),e.uses?.parent&&t.push('"parent":1'),e.uses?.route&&t.push('"route":1'),e.uses?.url&&t.push('"url":1'),`"uses":{${t.join(",")}}`}async function Pt(e,t,r){const n=e.request.method;let s=t[n];if(!s&&n==="HEAD"&&(s=t.GET),!s)return Rt(t,n);const o=t.prerender??r.prerender_default;if(o&&(t.POST||t.PATCH||t.PUT||t.DELETE))throw new Error("Cannot prerender endpoints that have mutative methods");if(r.prerendering&&!o){if(r.depth>0)throw new Error(`${e.route.id} is not prerenderable`);return new Response(void 0,{status:204})}try{const i=await s(e);if(!(i instanceof Response))throw new Error(`Invalid response from route ${e.url.pathname}: handler should return a Response object`);return r.prerendering&&i.headers.set("x-sveltekit-prerender",String(o)),i}catch(i){if(i instanceof I)return new Response(void 0,{status:i.status,headers:{location:i.location}});throw i}}function Ct(e){const{method:t,headers:r}=e.request;if(t==="PUT"||t==="PATCH"||t==="DELETE"||t==="OPTIONS")return!0;if(t==="POST"&&r.get("x-sveltekit-action")==="true")return!1;const n=e.request.headers.get("accept")??"*/*";return ge(n,["*","text/html"])!=="text/html"}function Re(e){return e.filter(t=>t!=null)}function be(e,t){return e==="/"||t==="ignore"?e:t==="never"?e.endsWith("/")?e.slice(0,-1):e:t==="always"&&!e.endsWith("/")?e+"/":e}function Tt(e){return e.split("%25").map(decodeURI).join("%25")}function qt(e){for(const t in e)e[t]=decodeURIComponent(e[t]);return e}const Nt=["href","pathname","search","searchParams","toString","toJSON"];function It(e,t){const r=new URL(e);for(const n of Nt){let s=r[n];Object.defineProperty(r,n,{get(){return t(),s},enumerable:!0,configurable:!0})}return r[Symbol.for("nodejs.util.inspect.custom")]=(n,s,o)=>o(e,s),Ut(r),r}function Ut(e){Object.defineProperty(e,"hash",{get(){throw new Error("Cannot access event.url.hash. Consider using `$page.url.hash` inside a component instead")}})}function Ve(e){for(const t of["search","searchParams"])Object.defineProperty(e,t,{get(){throw new Error(`Cannot access url.${t} on a page with prerendering enabled`)}})}const ke="/__data.json";function zt(e){return e.endsWith(ke)}function Dt(e){return e.replace(/\/$/,"")+ke}function Ae(e){return e.slice(0,-ke.length)}const le={"<":"\\u003C",">":"\\u003E","/":"\\u002F","\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\0":"\\u0000","\u2028":"\\u2028","\u2029":"\\u2029"};class J extends Error{constructor(t,r){super(t),this.name="DevalueError",this.path=r.join("")}}function W(e){return Object(e)!==e}const Ht=Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Ge(e){const t=Object.getPrototypeOf(e);return t===Object.prototype||t===null||Object.getOwnPropertyNames(t).sort().join("\0")===Ht}function ee(e){return Object.prototype.toString.call(e).slice(8,-1)}function z(e){let t='"';for(let r=0;r<e.length;r+=1){const n=e.charAt(r),s=n.charCodeAt(0);if(n==='"')t+='\\"';else if(n in le)t+=le[n];else if(s<=31)t+=`\\u${s.toString(16).toUpperCase().padStart(4,"0")}`;else if(s>=55296&&s<=57343){const o=e.charCodeAt(r+1);s<=56319&&o>=56320&&o<=57343?t+=n+e[++r]:t+=`\\u${s.toString(16).toUpperCase()}`}else t+=n}return t+='"',t}const oe="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_$",Lt=/[<>\b\f\n\r\t\0\u2028\u2029]/g,Wt=/^(?:do|if|in|for|int|let|new|try|var|byte|case|char|else|enum|goto|long|this|void|with|await|break|catch|class|const|final|float|short|super|throw|while|yield|delete|double|export|import|native|return|switch|throws|typeof|boolean|default|extends|finally|package|private|abstract|continue|debugger|function|volatile|interface|protected|transient|implements|instanceof|synchronized)$/;function F(e,t){const r=new Map,n=[],s=new Map;function o(a){if(typeof a=="function")throw new J("Cannot stringify a function",n);if(!W(a)){if(r.has(a)){r.set(a,r.get(a)+1);return}if(r.set(a,1),t){const c=t(a);if(typeof c=="string"){s.set(a,c);return}}switch(ee(a)){case"Number":case"BigInt":case"String":case"Boolean":case"Date":case"RegExp":return;case"Array":a.forEach((c,y)=>{n.push(`[${y}]`),o(c),n.pop()});break;case"Set":Array.from(a).forEach(o);break;case"Map":for(const[c,y]of a)n.push(`.get(${W(c)?ae(c):"..."})`),o(y),n.pop();break;default:if(!Ge(a))throw new J("Cannot stringify arbitrary non-POJOs",n);if(Object.getOwnPropertySymbols(a).length>0)throw new J("Cannot stringify POJOs with symbolic keys",n);for(const c in a)n.push(`.${c}`),o(a[c]),n.pop()}}}o(e);const i=new Map;Array.from(r).filter(a=>a[1]>1).sort((a,u)=>u[1]-a[1]).forEach((a,u)=>{i.set(a[0],Mt(u))});function f(a){if(i.has(a))return i.get(a);if(W(a))return ae(a);if(s.has(a))return s.get(a);const u=ee(a);switch(u){case"Number":case"String":case"Boolean":return`Object(${f(a.valueOf())})`;case"RegExp":return`new RegExp(${z(a.source)}, "${a.flags}")`;case"Date":return`new Date(${a.getTime()})`;case"Array":const c=a.map((p,m)=>m in a?f(p):""),y=a.length===0||a.length-1 in a?"":",";return`[${c.join(",")}${y}]`;case"Set":case"Map":return`new ${u}([${Array.from(a).map(f).join(",")}])`;default:const l=`{${Object.keys(a).map(p=>`${Ft(p)}:${f(a[p])}`).join(",")}}`;return Object.getPrototypeOf(a)===null?Object.keys(a).length>0?`Object.assign(Object.create(null),${l})`:"Object.create(null)":l}}const d=f(e);if(i.size){const a=[],u=[],c=[];return i.forEach((y,l)=>{if(a.push(y),s.has(l)){c.push(s.get(l));return}if(W(l)){c.push(ae(l));return}switch(ee(l)){case"Number":case"String":case"Boolean":c.push(`Object(${f(l.valueOf())})`);break;case"RegExp":c.push(l.toString());break;case"Date":c.push(`new Date(${l.getTime()})`);break;case"Array":c.push(`Array(${l.length})`),l.forEach((p,m)=>{u.push(`${y}[${m}]=${f(p)}`)});break;case"Set":c.push("new Set"),u.push(`${y}.${Array.from(l).map(p=>`add(${f(p)})`).join(".")}`);break;case"Map":c.push("new Map"),u.push(`${y}.${Array.from(l).map(([p,m])=>`set(${f(p)}, ${f(m)})`).join(".")}`);break;default:c.push(Object.getPrototypeOf(l)===null?"Object.create(null)":"{}"),Object.keys(l).forEach(p=>{u.push(`${y}${Bt(p)}=${f(l[p])}`)})}}),u.push(`return ${d}`),`(function(${a.join(",")}){${u.join(";")}}(${c.join(",")}))`}else return d}function Mt(e){let t="";do t=oe[e%oe.length]+t,e=~~(e/oe.length)-1;while(e>=0);return Wt.test(t)?`${t}0`:t}function Jt(e){return le[e]||e}function Ze(e){return e.replace(Lt,Jt)}function Ft(e){return/^[_$a-zA-Z][_$a-zA-Z0-9]*$/.test(e)?e:Ze(JSON.stringify(e))}function Bt(e){return/^[_$a-zA-Z][_$a-zA-Z0-9]*$/.test(e)?`.${e}`:`[${Ze(JSON.stringify(e))}]`}function ae(e){if(typeof e=="string")return z(e);if(e===void 0)return"void 0";if(e===0&&1/e<0)return"-0";const t=String(e);return typeof e=="number"?t.replace(/^(-)?0\./,"$1."):typeof e=="bigint"?e+"n":t}const Xe=-1,Vt=-2,Gt=-3,Zt=-4,Xt=-5,Ye=-6;function te(e,t){const r=[],n=new Map,s=[];for(const a in t)s.push({key:a,fn:t[a]});const o=[];let i=0;function f(a){if(typeof a=="function")throw new J("Cannot stringify a function",o);if(n.has(a))return n.get(a);if(a===void 0)return Xe;if(Number.isNaN(a))return Gt;if(a===1/0)return Zt;if(a===-1/0)return Xt;if(a===0&&1/a<0)return Ye;const u=i++;n.set(a,u);for(const{key:y,fn:l}of s){const h=l(a);if(h)return r[u]=`["${y}",${f(h)}]`,u}let c="";if(W(a))c=ie(a);else switch(ee(a)){case"Number":case"String":case"Boolean":c=`["Object",${ie(a)}]`;break;case"BigInt":c=`["BigInt",${a}]`;break;case"Date":c=`["Date","${a.toISOString()}"]`;break;case"RegExp":const{source:l,flags:h}=a;c=h?`["RegExp",${z(l)},"${h}"]`:`["RegExp",${z(l)}]`;break;case"Array":c="[";for(let p=0;p<a.length;p+=1)p>0&&(c+=","),p in a?(o.push(`[${p}]`),c+=f(a[p]),o.pop()):c+=Vt;c+="]";break;case"Set":c='["Set"';for(const p of a)c+=`,${f(p)}`;c+="]";break;case"Map":c='["Map"';for(const[p,m]of a)o.push(`.get(${W(p)?ie(p):"..."})`),c+=`,${f(p)},${f(m)}`;c+="]";break;default:if(!Ge(a))throw new J("Cannot stringify arbitrary non-POJOs",o);if(Object.getOwnPropertySymbols(a).length>0)throw new J("Cannot stringify POJOs with symbolic keys",o);if(Object.getPrototypeOf(a)===null){c='["null"';for(const p in a)o.push(`.${p}`),c+=`,${z(p)},${f(a[p])}`,o.pop();c+="]"}else{c="{";let p=!1;for(const m in a)p&&(c+=","),p=!0,o.push(`.${m}`),c+=`${z(m)}:${f(a[m])}`,o.pop();c+="}"}}return r[u]=c,u}const d=f(e);return d<0?`${d}`:`[${r.join(",")}]`}function ie(e){const t=typeof e;return t==="string"?z(e):e instanceof String?z(e.toString()):e===void 0?Xe.toString():e===0&&1/e<0?Ye.toString():t==="bigint"?`["BigInt","${e}"]`:String(e)}function Yt(e){return ge(e.request.headers.get("accept")??"*/*",["application/json","text/html"])==="application/json"&&e.request.method==="POST"}async function Kt(e,t,r){const n=r?.actions;if(!n){const s=_e(405,"POST method not allowed. No actions exist for this page");return G({type:"error",error:await C(e,t,s)},{status:s.status,headers:{allow:"GET"}})}Qe(n);try{const s=await et(e,n);return s instanceof we?G({type:"failure",status:s.status,data:Pe(s.data,e.route.id)}):G({type:"success",status:s?200:204,data:Pe(s,e.route.id)})}catch(s){const o=s;return o instanceof I?G({type:"redirect",status:o.status,location:o.location}):G({type:"error",error:await C(e,t,Ke(o))},{status:o instanceof D?o.status:500})}}function Ke(e){return e instanceof we?new Error('Cannot "throw fail()". Use "return fail()"'):e}function G(e,t){return me(e,t)}function Qt(e){return e.request.method==="POST"}async function er(e,t){const r=t?.actions;if(!r)return e.setHeaders({allow:"GET"}),{type:"error",error:_e(405,"POST method not allowed. No actions exist for this page")};Qe(r);try{const n=await et(e,r);return n instanceof we?{type:"failure",status:n.status,data:n.data}:{type:"success",status:200,data:n}}catch(n){const s=n;return s instanceof I?{type:"redirect",status:s.status,location:s.location}:{type:"error",error:Ke(s)}}}function Qe(e){if(e.default&&Object.keys(e).length>1)throw new Error("When using named actions, the default action cannot be used. See the docs for more info: https://kit.svelte.dev/docs/form-actions#named-actions")}async function et(e,t){const r=new URL(e.request.url);let n="default";for(const o of r.searchParams)if(o[0].startsWith("/")){if(n=o[0].slice(1),n==="default")throw new Error('Cannot use reserved action name "default"');break}const s=t[n];if(!s)throw new Error(`No action with name '${n}' found`);if(!Je(e.request))throw new Error(`Actions expect form-encoded data (received ${e.request.headers.get("content-type")})`);return s(e)}function tr(e,t){return tt(e,F,t)}function Pe(e,t){return tt(e,te,t)}function tt(e,t,r){try{return t(e)}catch(n){const s=n;if("path"in s){let o=`Data returned from action inside ${r} is not serializable: ${s.message}`;throw s.path!==""&&(o+=` (data.${s.path})`),new Error(o)}throw s}}async function rt(e){for(const t in e)if(typeof e[t]?.then=="function")return Object.fromEntries(await Promise.all(Object.entries(e).map(async([r,n])=>[r,await n])));return e}async function je({event:e,state:t,node:r,parent:n}){if(!r?.server)return null;const s={dependencies:new Set,params:new Set,parent:!1,route:!1,url:!1},o=It(e.url,()=>{s.url=!0});t.prerendering&&Ve(o);const i=await r.server.load?.call(null,{...e,fetch:(d,a)=>{const u=new URL(d instanceof Request?d.url:d,e.url);return s.dependencies.add(u.href),e.fetch(d,a)},depends:(...d)=>{for(const a of d){const{href:u}=new URL(a,e.url);s.dependencies.add(u)}},params:new Proxy(e.params,{get:(d,a)=>(s.params.add(a),d[a])}),parent:async()=>(s.parent=!0,n()),route:new Proxy(e.route,{get:(d,a)=>(s.route=!0,d[a])}),url:o});return{type:"data",data:i?await rt(i):null,uses:s,slash:r.server.trailingSlash}}async function nt({event:e,fetched:t,node:r,parent:n,server_data_promise:s,state:o,resolve_opts:i,csr:f}){const d=await s;if(!r?.universal?.load)return d?.data??null;const a=await r.universal.load.call(null,{url:e.url,params:e.params,data:d?.data??null,route:e.route,fetch:rr(e,o,t,f,i),setHeaders:e.setHeaders,depends:()=>{},parent:n});return a?await rt(a):null}function rr(e,t,r,n,s){return async(o,i)=>{const f=o instanceof Request&&o.body?o.clone().body:null;let d=await e.fetch(o,i);const a=new URL(o instanceof Request?o.url:o,e.url),u=a.origin===e.url.origin;let c;if(u)t.prerendering&&(c={response:d,body:null},t.prerendering.dependencies.set(a.pathname,c));else if((o instanceof Request?o.mode:i?.mode??"cors")==="no-cors")d=new Response("",{status:d.status,statusText:d.statusText,headers:d.headers});else{const h=d.headers.get("access-control-allow-origin");if(!h||h!==e.url.origin&&h!=="*")throw new Error(`CORS error: ${h?"Incorrect":"No"} 'Access-Control-Allow-Origin' header is present on the requested resource`)}const y=new Proxy(d,{get(l,h,p){async function m(){const w=await l.text();if(!w||typeof w=="string"){const $=Number(l.status);if(isNaN($))throw new Error(`response.status is not a number. value: "${l.status}" type: ${typeof l.status}`);r.push({url:u?a.href.slice(e.url.origin.length):a.href,method:e.request.method,request_body:o instanceof Request&&f?await nr(f):i?.body,request_headers:i?.headers,response_body:w,response:l})}return c&&(c.body=w),w}return h==="arrayBuffer"?async()=>{const w=await l.arrayBuffer();return c&&(c.body=new Uint8Array(w)),w}:h==="text"?m:h==="json"?async()=>JSON.parse(await m()):Reflect.get(l,h,l)}});if(n){const l=d.headers.get;d.headers.get=h=>{const p=h.toLowerCase(),m=l.call(d.headers,p);if(m&&!p.startsWith("x-sveltekit-")&&!s.filterSerializedResponseHeaders(p,m))throw new Error(`Failed to get response header "${p}" — it must be included by the \`filterSerializedResponseHeaders\` option: https://kit.svelte.dev/docs/hooks#server-hooks-handle (at ${e.route.id})`);return m}}return y}}async function nr(e){let t="";const r=e.getReader(),n=new TextDecoder;for(;;){const{done:s,value:o}=await r.read();if(s)break;t+=n.decode(o)}return t}function st(...e){let t=5381;for(const r of e)if(typeof r=="string"){let n=r.length;for(;n;)t=t*33^r.charCodeAt(--n)}else if(ArrayBuffer.isView(r)){const n=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);let s=n.length;for(;s;)t=t*33^n[--s]}else throw new TypeError("value must be a string or TypedArray");return(t>>>0).toString(36)}const ot={"&":"&amp;",'"':"&quot;"},sr=new RegExp(`[${Object.keys(ot).join("")}]|[\\ud800-\\udbff](?![\\udc00-\\udfff])|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\udc00-\\udfff]`,"g");function at(e){return`"${e.replace(sr,r=>r.length===2?r:ot[r]??`&#${r.charCodeAt(0)};`)}"`}const it={"<":"\\u003C","\u2028":"\\u2028","\u2029":"\\u2029"},or=new RegExp(`[${Object.keys(it).join("")}]`,"g");function ar(e,t,r=!1){const n={};let s=null,o=null,i=!1;for(const[u,c]of e.response.headers)t(u,c)&&(n[u]=c),u==="cache-control"&&(s=c),u==="age"&&(o=c),u==="vary"&&(i=!0);const f={status:e.response.status,statusText:e.response.statusText,headers:n,body:e.response_body},d=JSON.stringify(f).replace(or,u=>it[u]),a=['type="application/json"',"data-sveltekit-fetched",`data-url=${at(e.url)}`];if(e.request_headers||e.request_body){const u=[];e.request_headers&&u.push([...new Headers(e.request_headers)].join(",")),e.request_body&&u.push(e.request_body),a.push(`data-hash="${st(...u)}"`)}if(!r&&e.method==="GET"&&s&&!i){const u=/s-maxage=(\d+)/g.exec(s)??/max-age=(\d+)/g.exec(s);if(u){const c=+u[1]-+(o??"0");a.push(`data-ttl="${c}"`)}}return`<script ${a.join(" ")}>${d}<\/script>`}const U=JSON.stringify,ir=new TextEncoder;function Ce(e){fe[0]||cr();const t=ct.slice(0),r=ur(e);for(let s=0;s<r.length;s+=16){const o=r.subarray(s,s+16);let i,f,d,a=t[0],u=t[1],c=t[2],y=t[3],l=t[4],h=t[5],p=t[6],m=t[7];for(let w=0;w<64;w++)w<16?i=o[w]:(f=o[w+1&15],d=o[w+14&15],i=o[w&15]=(f>>>7^f>>>18^f>>>3^f<<25^f<<14)+(d>>>17^d>>>19^d>>>10^d<<15^d<<13)+o[w&15]+o[w+9&15]|0),i=i+m+(l>>>6^l>>>11^l>>>25^l<<26^l<<21^l<<7)+(p^l&(h^p))+fe[w],m=p,p=h,h=l,l=y+i|0,y=c,c=u,u=a,a=i+(u&c^y&(u^c))+(u>>>2^u>>>13^u>>>22^u<<30^u<<19^u<<10)|0;t[0]=t[0]+a|0,t[1]=t[1]+u|0,t[2]=t[2]+c|0,t[3]=t[3]+y|0,t[4]=t[4]+l|0,t[5]=t[5]+h|0,t[6]=t[6]+p|0,t[7]=t[7]+m|0}const n=new Uint8Array(t.buffer);return ut(n),lt(n)}const ct=new Uint32Array(8),fe=new Uint32Array(64);function cr(){function e(r){return(r-Math.floor(r))*4294967296}let t=2;for(let r=0;r<64;t++){let n=!0;for(let s=2;s*s<=t;s++)if(t%s===0){n=!1;break}n&&(r<8&&(ct[r]=e(t**(1/2))),fe[r]=e(t**(1/3)),r++)}}function ut(e){for(let t=0;t<e.length;t+=4){const r=e[t+0],n=e[t+1],s=e[t+2],o=e[t+3];e[t+0]=o,e[t+1]=s,e[t+2]=n,e[t+3]=r}}function ur(e){const t=ir.encode(e),r=t.length*8,n=512*Math.ceil((r+65)/512),s=new Uint8Array(n/8);s.set(t),s[t.length]=128,ut(s);const o=new Uint32Array(s.buffer);return o[o.length-2]=Math.floor(r/4294967296),o[o.length-1]=r,o}const q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");function lt(e){const t=e.length;let r="",n;for(n=2;n<t;n+=3)r+=q[e[n-2]>>2],r+=q[(e[n-2]&3)<<4|e[n-1]>>4],r+=q[(e[n-1]&15)<<2|e[n]>>6],r+=q[e[n]&63];return n===t+1&&(r+=q[e[n-2]>>2],r+=q[(e[n-2]&3)<<4],r+="=="),n===t&&(r+=q[e[n-2]>>2],r+=q[(e[n-2]&3)<<4|e[n-1]>>4],r+=q[(e[n-1]&15)<<2],r+="="),r}const Te=new Uint8Array(16);function lr(){return crypto.getRandomValues(Te),lt(Te)}const fr=new Set(["self","unsafe-eval","unsafe-hashes","unsafe-inline","none","strict-dynamic","report-sample","wasm-unsafe-eval","script"]),dr=/^(nonce|sha\d\d\d)-/;class ft{#e;#t;#s;#o;#r;#n;#a;constructor(t,r,n){this.#e=t,this.#o=r;const s=this.#o;this.#r=[],this.#n=[];const o=s["script-src"]||s["default-src"],i=s["style-src"]||s["default-src"];this.#t=!!o&&o.filter(f=>f!=="unsafe-inline").length>0,this.#s=!!i&&i.filter(f=>f!=="unsafe-inline").length>0,this.script_needs_nonce=this.#t&&!this.#e,this.style_needs_nonce=this.#s&&!this.#e,this.#a=n}add_script(t){this.#t&&(this.#e?this.#r.push(`sha256-${Ce(t)}`):this.#r.length===0&&this.#r.push(`nonce-${this.#a}`))}add_style(t){this.#s&&(this.#e?this.#n.push(`sha256-${Ce(t)}`):this.#n.length===0&&this.#n.push(`nonce-${this.#a}`))}get_header(t=!1){const r=[],n={...this.#o};this.#n.length>0&&(n["style-src"]=[...n["style-src"]||n["default-src"]||[],...this.#n]),this.#r.length>0&&(n["script-src"]=[...n["script-src"]||n["default-src"]||[],...this.#r]);for(const s in n){if(t&&(s==="frame-ancestors"||s==="report-uri"||s==="sandbox"))continue;const o=n[s];if(!o)continue;const i=[s];Array.isArray(o)&&o.forEach(f=>{fr.has(f)||dr.test(f)?i.push(`'${f}'`):i.push(f)}),r.push(i.join(" "))}return r.join("; ")}}class pr extends ft{get_meta(){return`<meta http-equiv="content-security-policy" content=${at(this.get_header(!0))}>`}}class hr extends ft{constructor(t,r,n){if(super(t,r,n),Object.values(r).filter(s=>!!s).length>0){const s=r["report-to"]?.length??0>0,o=r["report-uri"]?.length??0>0;if(!s&&!o)throw Error("`content-security-policy-report-only` must be specified with either the `report-to` or `report-uri` directives, or both")}}}class yr{nonce=lr();csp_provider;report_only_provider;constructor({mode:t,directives:r,reportOnly:n},{prerender:s}){const o=t==="hash"||t==="auto"&&s;this.csp_provider=new pr(o,r,this.nonce),this.report_only_provider=new hr(o,n,this.nonce)}get script_needs_nonce(){return this.csp_provider.script_needs_nonce||this.report_only_provider.script_needs_nonce}get style_needs_nonce(){return this.csp_provider.style_needs_nonce||this.report_only_provider.style_needs_nonce}add_script(t){this.csp_provider.add_script(t),this.report_only_provider.add_script(t)}add_style(t){this.csp_provider.add_style(t),this.report_only_provider.add_style(t)}}function qe(){let e,t;return{promise:new Promise((n,s)=>{e=n,t=s}),fulfil:e,reject:t}}function dt(){let e=[qe()];return{iterator:{[Symbol.asyncIterator](){return{next:async()=>{const t=await e[0].promise;return t.done||e.shift(),t}}}},push:t=>{e[e.length-1].fulfil({value:t,done:!1}),e.push(qe())},done:()=>{e[e.length-1].fulfil({done:!0})}}}const mr="/_svelte_kit_assets",_r={...Et(!1),check:()=>!1},Ne=new TextEncoder;async function Z({branch:e,fetched:t,options:r,manifest:n,state:s,page_config:o,status:i,error:f=null,event:d,resolve_opts:a,action_result:u}){if(s.prerendering){if(r.csp.mode==="nonce")throw new Error('Cannot use prerendering if config.kit.csp.mode === "nonce"');if(r.app_template_contains_nonce)throw new Error("Cannot use prerendering if page template contains %sveltekit.nonce%")}const{client:c}=n._,y=new Set([...c.start.imports,...c.app.imports]),l=new Set(c.app.stylesheets),h=new Set(c.app.fonts),p=new Set,m=new Map;let w;const $=u?.type==="success"||u?.type==="failure"?u.data??null:null;let _=T,b=L,j=U(T);if(!s.prerendering?.fallback){const k=d.url.pathname.slice(T.length).split("/");k.length===1&&T!==""?(_=`./${T.split("/").at(-1)}`,j=`new URL(${U(_)}, location).pathname`):(_=k.slice(2).map(()=>"..").join("/")||".",j=`new URL(${U(_)}, location).pathname.slice(0, -1)`),(!L||L[0]==="/"&&L!==mr)&&(b=_)}if(o.ssr){const k={stores:{page:Oe(null),navigating:Oe(null),updated:_r},constructors:await Promise.all(e.map(({node:O})=>O.component())),form:$};let v={};for(let O=0;O<e.length;O+=1)v={...v,...e[O].data},k[`data_${O}`]=v;k.page={error:f,params:d.params,route:d.route,status:i,url:d.url,data:v,form:$};try{w=r.root.render(k)}finally{kt()}for(const{node:O}of e){for(const S of O.imports)y.add(S);for(const S of O.stylesheets)l.add(S);for(const S of O.fonts)h.add(S);O.inline_styles&&Object.entries(await O.inline_styles()).forEach(([S,K])=>m.set(S,K))}}else w={head:"",html:"",css:{code:"",map:null}};let g="",x=w.html;const E=new yr(r.csp,{prerender:!!s.prerendering}),A=k=>k.startsWith("/")?T+k:`${b}/${k}`;if(m.size>0){const k=Array.from(m.values()).join(`
`),v=[];E.style_needs_nonce&&v.push(` nonce="${E.nonce}"`),E.add_style(k),g+=`
	<style${v.join("")}>${k}</style>`}for(const k of l){const v=A(k),O=['rel="stylesheet"'];if(m.has(k))O.push("disabled",'media="(max-width: 0)"');else if(a.preload({type:"css",path:v})){const S=['rel="preload"','as="style"'];p.add(`<${encodeURI(v)}>; ${S.join(";")}; nopush`)}g+=`
		<link href="${v}" ${O.join(" ")}>`}for(const k of h){const v=A(k);if(a.preload({type:"font",path:v})){const S=['rel="preload"','as="font"',`type="font/${k.slice(k.lastIndexOf(".")+1)}"`,`href="${v}"`,"crossorigin"];g+=`
		<link ${S.join(" ")}>`}}const H=`__sveltekit_${r.version_hash}`,{data:B,chunks:Y}=wr(d,r,e.map(k=>k.server_data),H);if(o.ssr&&o.csr&&(x+=`
			${t.map(k=>ar(k,a.filterSerializedResponseHeaders,!!s.prerendering)).join(`
			`)}`),o.csr){const k=Array.from(y,R=>A(R)).filter(R=>a.preload({type:"js",path:R}));for(const R of k)p.add(`<${encodeURI(R)}>; rel="modulepreload"; nopush`),r.preload_strategy!=="modulepreload"?g+=`
		<link rel="preload" as="script" crossorigin="anonymous" href="${R}">`:s.prerendering&&(g+=`
		<link rel="modulepreload" href="${R}">`);const v=[],O=[`env: ${U(Ee)}`,L&&`assets: ${U(L)}`,`base: ${j}`,"element: document.currentScript.parentElement"].filter(Boolean);Y&&(v.push("const deferred = new Map();"),O.push(`defer: (id) => new Promise((fulfil, reject) => {
							deferred.set(id, { fulfil, reject });
						})`),O.push(`resolve: ({ id, data, error }) => {
							const { fulfil, reject } = deferred.get(id);
							deferred.delete(id);

							if (error) reject(error);
							else fulfil(data);
						}`)),v.push(`${H} = {
						${O.join(`,
						`)}
					};`);const S=["app",`${H}.element`];if(o.ssr){const R={form:"null",error:"null"};v.push(`const data = ${B};`),$&&(R.form=tr($,d.route.id)),f&&(R.error=F(f));const se=[`node_ids: [${e.map(({node:bt})=>bt.index).join(", ")}]`,"data",`form: ${R.form}`,`error: ${R.error}`];i!==200&&se.push(`status: ${i}`),r.embedded&&se.push(`params: ${F(d.params)}`,`route: ${U(d.route)}`),S.push(`{
							${se.join(`,
							`)}
						}`)}if(v.push(`Promise.all([
						import(${U(A(c.start.file))}),
						import(${U(A(c.app.file))})
					]).then(([kit, app]) => {
						kit.start(${S.join(", ")});
					});`),r.service_worker){const R="";v.push(`if ('serviceWorker' in navigator) {
						addEventListener('load', function () {
							navigator.serviceWorker.register('${A("service-worker.js")}'${R});
						});
					}`)}const K=`
				{
					${v.join(`

					`)}
				}
			`;E.add_script(K),x+=`
			<script${E.script_needs_nonce?` nonce="${E.nonce}"`:""}>${K}<\/script>
		`}const V=new Headers({"x-sveltekit-page":"true","content-type":"text/html"});if(s.prerendering){const k=[],v=E.csp_provider.get_meta();v&&k.push(v),s.prerendering.cache&&k.push(`<meta http-equiv="cache-control" content="${s.prerendering.cache}">`),k.length>0&&(g=k.join(`
`)+g)}else{const k=E.csp_provider.get_header();k&&V.set("content-security-policy",k);const v=E.report_only_provider.get_header();v&&V.set("content-security-policy-report-only",v),p.size&&V.set("link",Array.from(p).join(", "))}g+=w.head;const $t=r.templates.app({head:g,body:x,assets:b,nonce:E.nonce,env:Ee}),ne=await a.transformPageChunk({html:$t,done:!0})||"";return Y||V.set("etag",`"${st(ne)}"`),Y?new Response(new ReadableStream({async start(k){k.enqueue(Ne.encode(ne+`
`));for await(const v of Y)k.enqueue(Ne.encode(v));k.close()},type:"bytes"}),{headers:{"content-type":"text/html"}}):P(ne,{status:i,headers:V})}function wr(e,t,r,n){let s=1,o=0;const{iterator:i,push:f,done:d}=dt();function a(u){if(typeof u?.then=="function"){const c=s++;return o+=1,u.then(y=>({data:y})).catch(async y=>({error:await C(e,t,y)})).then(async({data:y,error:l})=>{o-=1;let h;try{h=F({id:c,data:y,error:l},a)}catch{l=await C(e,t,new Error(`Failed to serialize promise while rendering ${e.route.id}`)),y=void 0,h=F({id:c,data:y,error:l},a)}f(`<script>${n}.resolve(${h})<\/script>
`),o===0&&d()}),`${n}.defer(${c})`}}try{return{data:`[${r.map(c=>c?`{"type":"data","data":${F(c.data,a)},${Be(c)}${c.slash?`,"slash":${JSON.stringify(c.slash)}`:""}}`:"null").join(",")}]`,chunks:o>0?i:null}}catch(u){throw new Error(Fe(e,u))}}function N(e,t){return e.reduce((r,n)=>n?.universal?.[t]??n?.server?.[t]??r,void 0)}async function pt({event:e,options:t,manifest:r,state:n,status:s,error:o,resolve_opts:i}){const f=[];try{const d=[],a=await r._.nodes[0](),u=N([a],"ssr")??!0,c=N([a],"csr")??!0;if(u){n.error=!0;const y=je({event:e,state:n,node:a,parent:async()=>({})}),l=await y,h=await nt({event:e,fetched:f,node:a,parent:async()=>({}),resolve_opts:i,server_data_promise:y,state:n,csr:c});d.push({node:a,server_data:l,data:h},{node:await r._.nodes[1](),data:null,server_data:null})}return await Z({options:t,manifest:r,state:n,page_config:{ssr:u,csr:N([a],"csr")??!0},status:s,error:await C(e,t,o),branch:d,fetched:f,event:e,resolve_opts:i})}catch(d){return d instanceof I?re(d.status,d.location):$e(t,d instanceof D?d.status:500,(await C(e,t,d)).message)}}function gr(e){let t=!1,r;return()=>t?r:(t=!0,r=e())}const Ie="x-sveltekit-invalidated",Ue=new TextEncoder;async function $r(e,t,r,n,s,o,i){if(!t.page)return new Response(void 0,{status:404});try{const f=[...t.page.layouts,t.page.leaf],d=o??f.map(()=>!0);let a=!1;const u=new URL(e.url);u.pathname=be(u.pathname,i);const c={...e,url:u},y=f.map(($,_)=>gr(async()=>{try{if(a)return{type:"skip"};const b=$==null?$:await n._.nodes[$]();return je({event:c,state:s,node:b,parent:async()=>{const j={};for(let g=0;g<_;g+=1){const x=await y[g]();x&&Object.assign(j,x.data)}return j}})}catch(b){throw a=!0,b}})),l=y.map(async($,_)=>d[_]?$():{type:"skip"});let h=l.length;const p=await Promise.all(l.map(($,_)=>$.catch(async b=>{if(b instanceof I)throw b;return h=Math.min(h,_+1),{type:"error",error:await C(e,r,b),status:b instanceof D?b.status:void 0}}))),{data:m,chunks:w}=ht(e,r,p);return w?new Response(new ReadableStream({async start($){$.enqueue(Ue.encode(m));for await(const _ of w)$.enqueue(Ue.encode(_));$.close()},type:"bytes"}),{headers:{"content-type":"text/sveltekit-data","cache-control":"private, no-store"}}):de(m)}catch(f){const d=f;return d instanceof I?pe(d):de(await C(e,r,d),500)}}function de(e,t=200){return P(typeof e=="string"?e:JSON.stringify(e),{status:t,headers:{"content-type":"application/json","cache-control":"private, no-store"}})}function pe(e){return de({type:"redirect",location:e.location})}function ht(e,t,r){let n=1,s=0;const{iterator:o,push:i,done:f}=dt(),d={Promise:a=>{if(typeof a?.then=="function"){const u=n++;s+=1;let c="data";return a.catch(async y=>(c="error",C(e,t,y))).then(async y=>{let l;try{l=te(y,d)}catch{const p=await C(e,t,new Error(`Failed to serialize promise while rendering ${e.route.id}`));c="error",l=te(p,d)}s-=1,i(`{"type":"chunk","id":${u},"${c}":${l}}
`),s===0&&f()}),u}}};try{return{data:`{"type":"data","nodes":[${r.map(u=>u?u.type==="error"||u.type==="skip"?JSON.stringify(u):`{"type":"data","data":${te(u.data,d)},${Be(u)}${u.slash?`,"slash":${JSON.stringify(u.slash)}`:""}}`:"null").join(",")}]}
`,chunks:s>0?o:null}}catch(a){throw new Error(Fe(e,a))}}const br=10;async function kr(e,t,r,n,s,o){if(s.depth>br)return P(`Not found: ${e.url.pathname}`,{status:404});if(Yt(e)){const i=await n._.nodes[t.leaf]();return Kt(e,r,i?.server)}try{const i=await Promise.all([...t.layouts.map(_=>_==null?_:n._.nodes[_]()),n._.nodes[t.leaf]()]),f=i.at(-1);let d=200,a;if(Qt(e)){if(a=await er(e,f.server),a?.type==="redirect")return re(a.status,a.location);if(a?.type==="error"){const _=a.error;d=_ instanceof D?_.status:500}a?.type==="failure"&&(d=a.status)}const u=i.some(_=>_?.server),c=Dt(e.url.pathname),y=N(i,"prerender")??!1;if(y){if(f.server?.actions)throw new Error("Cannot prerender pages with actions")}else if(s.prerendering)return new Response(void 0,{status:204});s.prerender_default=y;const l=[];if(N(i,"ssr")===!1)return await Z({branch:[],fetched:l,page_config:{ssr:!1,csr:N(i,"csr")??!0},status:d,error:null,event:e,options:r,manifest:n,state:s,resolve_opts:o});let h=[],p=null;const m=i.map((_,b)=>{if(p)throw p;return Promise.resolve().then(async()=>{try{if(_===f&&a?.type==="error")throw a.error;return await je({event:e,state:s,node:_,parent:async()=>{const j={};for(let g=0;g<b;g+=1){const x=await m[g];x&&Object.assign(j,await x.data)}return j}})}catch(j){throw p=j,p}})}),w=N(i,"csr")??!0,$=i.map((_,b)=>{if(p)throw p;return Promise.resolve().then(async()=>{try{return await nt({event:e,fetched:l,node:_,parent:async()=>{const j={};for(let g=0;g<b;g+=1)Object.assign(j,await $[g]);return j},resolve_opts:o,server_data_promise:m[b],state:s,csr:w})}catch(j){throw p=j,p}})});for(const _ of m)_.catch(()=>{});for(const _ of $)_.catch(()=>{});for(let _=0;_<i.length;_+=1){const b=i[_];if(b)try{const j=await m[_],g=await $[_];h.push({node:b,server_data:j,data:g})}catch(j){const g=j;if(g instanceof I){if(s.prerendering&&u){const A=JSON.stringify({type:"redirect",location:g.location});s.prerendering.dependencies.set(c,{response:P(A),body:A})}return re(g.status,g.location)}const x=g instanceof D?g.status:500,E=await C(e,r,g);for(;_--;)if(t.errors[_]){const A=t.errors[_],H=await n._.nodes[A]();let B=_;for(;!h[B];)B-=1;return await Z({event:e,options:r,manifest:n,state:s,resolve_opts:o,page_config:{ssr:!0,csr:!0},status:x,error:E,branch:Re(h.slice(0,B+1)).concat({node:H,data:null,server_data:null}),fetched:l})}return $e(r,x,E.message)}else h.push(null)}if(s.prerendering&&u){let{data:_,chunks:b}=ht(e,r,h.map(j=>j?.server_data));if(b)for await(const j of b)_+=j;s.prerendering.dependencies.set(c,{response:P(_),body:_})}return await Z({event:e,options:r,manifest:n,state:s,resolve_opts:o,page_config:{csr:N(i,"csr")??!0,ssr:!0},status:d,error:null,branch:Re(h),action_result:a,fetched:l})}catch(i){return await pt({event:e,options:r,manifest:n,state:s,status:500,error:i,resolve_opts:o})}}function jr(e,t,r){const n={},s=e.slice(1);let o=0;for(let i=0;i<t.length;i+=1){const f=t[i],d=s[i-o];if(f.chained&&f.rest&&o){n[f.name]=s.slice(i-o,i+1).filter(a=>a).join("/"),o=0;continue}if(d===void 0){f.rest&&(n[f.name]="");continue}if(!f.matcher||r[f.matcher](d)){n[f.name]=d;const a=t[i+1],u=s[i+1];a&&!a.rest&&a.optional&&u&&(o=0);continue}if(f.optional&&f.chained){o++;continue}return}if(!o)return n}function vr(e,t,r){const n=e.headers.get("cookie")??"",s=Q(n,{decode:c=>c}),i=be(t.pathname,r).split("/").slice(0,-1).join("/")||"/",f={},d={httpOnly:!0,sameSite:"lax",secure:!(t.hostname==="localhost"&&t.protocol==="http:")},a={get(c,y){const l=f[c];if(l&&ce(t.hostname,l.options.domain)&&ue(t.pathname,l.options.path))return l.value;const h=y?.decode||decodeURIComponent;return Q(n,{decode:h})[c]},getAll(c){const y=c?.decode||decodeURIComponent,l=Q(n,{decode:y});for(const h of Object.values(f))ce(t.hostname,h.options.domain)&&ue(t.pathname,h.options.path)&&(l[h.name]=h.value);return Object.entries(l).map(([h,p])=>({name:h,value:p}))},set(c,y,l={}){let h=l.path??i;f[c]={name:c,value:y,options:{...d,...l,path:h}}},delete(c,y={}){a.set(c,"",{...y,maxAge:0})},serialize(c,y,l){return Me(c,y,{...d,...l})}};function u(c,y){const l={...s};for(const h in f){const p=f[h];if(!ce(c.hostname,p.options.domain)||!ue(c.pathname,p.options.path))continue;const m=p.options.encode||encodeURIComponent;l[p.name]=m(p.value)}if(y){const h=Q(y,{decode:p=>p});for(const p in h)l[p]=h[p]}return Object.entries(l).map(([h,p])=>`${h}=${p}`).join("; ")}return{cookies:a,new_cookies:f,get_cookie_header:u}}function ce(e,t){if(!t)return!0;const r=t[0]==="."?t.slice(1):t;return e===r?!0:e.endsWith("."+r)}function ue(e,t){if(!t)return!0;const r=t.endsWith("/")?t.slice(0,-1):t;return e===r?!0:e.startsWith(r+"/")}function ze(e,t){for(const r of t){const{name:n,value:s,options:o}=r;e.append("set-cookie",Me(n,s,o))}}var X={},xr={get exports(){return X},set exports(e){X=e}},M={decodeValues:!0,map:!1,silent:!1};function he(e){return typeof e=="string"&&!!e.trim()}function ye(e,t){var r=e.split(";").filter(he),n=r.shift(),s=Er(n),o=s.name,i=s.value;t=t?Object.assign({},M,t):M;try{i=t.decodeValues?decodeURIComponent(i):i}catch(d){console.error("set-cookie-parser encountered an error while decoding a cookie with value '"+i+"'. Set options.decodeValues to false to disable this feature.",d)}var f={name:o,value:i};return r.forEach(function(d){var a=d.split("="),u=a.shift().trimLeft().toLowerCase(),c=a.join("=");u==="expires"?f.expires=new Date(c):u==="max-age"?f.maxAge=parseInt(c,10):u==="secure"?f.secure=!0:u==="httponly"?f.httpOnly=!0:u==="samesite"?f.sameSite=c:f[u]=c}),f}function Er(e){var t="",r="",n=e.split("=");return n.length>1?(t=n.shift(),r=n.join("=")):r=e,{name:t,value:r}}function yt(e,t){if(t=t?Object.assign({},M,t):M,!e)return t.map?{}:[];if(e.headers)if(typeof e.headers.getSetCookie=="function")e=e.headers.getSetCookie();else if(e.headers["set-cookie"])e=e.headers["set-cookie"];else{var r=e.headers[Object.keys(e.headers).find(function(s){return s.toLowerCase()==="set-cookie"})];!r&&e.headers.cookie&&!t.silent&&console.warn("Warning: set-cookie-parser appears to have been called on a request object. It is designed to parse Set-Cookie headers from responses, not Cookie headers from requests. Set the option {silent: true} to suppress this warning."),e=r}if(Array.isArray(e)||(e=[e]),t=t?Object.assign({},M,t):M,t.map){var n={};return e.filter(he).reduce(function(s,o){var i=ye(o,t);return s[i.name]=i,s},n)}else return e.filter(he).map(function(s){return ye(s,t)})}function Or(e){if(Array.isArray(e))return e;if(typeof e!="string")return[];var t=[],r=0,n,s,o,i,f;function d(){for(;r<e.length&&/\s/.test(e.charAt(r));)r+=1;return r<e.length}function a(){return s=e.charAt(r),s!=="="&&s!==";"&&s!==","}for(;r<e.length;){for(n=r,f=!1;d();)if(s=e.charAt(r),s===","){for(o=r,r+=1,d(),i=r;r<e.length&&a();)r+=1;r<e.length&&e.charAt(r)==="="?(f=!0,r=i,t.push(e.substring(n,o)),n=r):r=o+1}else r+=1;(!f||r>=e.length)&&t.push(e.substring(n,e.length))}return t}xr.exports=yt;X.parse=yt;var Sr=X.parseString=ye,Rr=X.splitCookiesString=Or;function Ar({event:e,options:t,manifest:r,state:n,get_cookie_header:s}){return async(o,i)=>{const f=De(o,i,e.url),d=i?.body;let a=(o instanceof Request?o.mode:i?.mode)??"cors",u=(o instanceof Request?o.credentials:i?.credentials)??"same-origin";return await t.hooks.handleFetch({event:e,request:f,fetch:async(c,y)=>{const l=De(c,y,e.url),h=new URL(l.url);if(l.headers.has("origin")||l.headers.set("origin",e.url.origin),c!==f&&(a=(c instanceof Request?c.mode:y?.mode)??"cors",u=(c instanceof Request?c.credentials:y?.credentials)??"same-origin"),(l.method==="GET"||l.method==="HEAD")&&(a==="no-cors"&&h.origin!==e.url.origin||h.origin===e.url.origin)&&l.headers.delete("origin"),h.origin!==e.url.origin){if(`.${h.hostname}`.endsWith(`.${e.url.hostname}`)&&u!=="omit"){const x=s(h,l.headers.get("cookie"));x&&l.headers.set("cookie",x)}return fetch(l)}let p;const m=L||T,w=decodeURIComponent(h.pathname),$=(w.startsWith(m)?w.slice(m.length):w).slice(1),_=`${$}/index.html`,b=r.assets.has($),j=r.assets.has(_);if(b||j){const x=b?$:_;if(n.read){const E=b?r.mimeTypes[$.slice($.lastIndexOf("."))]:"text/html";return new Response(n.read(x),{headers:E?{"content-type":E}:{}})}return await fetch(l)}if(u!=="omit"){const x=s(h,l.headers.get("cookie"));x&&l.headers.set("cookie",x);const E=e.request.headers.get("authorization");E&&!l.headers.has("authorization")&&l.headers.set("authorization",E)}if(d&&typeof d!="string"&&!ArrayBuffer.isView(d))throw new Error("Request body must be a string or TypedArray");l.headers.has("accept")||l.headers.set("accept","*/*"),l.headers.has("accept-language")||l.headers.set("accept-language",e.request.headers.get("accept-language")),p=await gt(l,t,r,{...n,depth:n.depth+1});const g=p.headers.get("set-cookie");if(g)for(const x of Rr(g)){const{name:E,value:A,...H}=Sr(x);e.cookies.set(E,A,H)}return p}})}}function De(e,t,r){return e instanceof Request?e:new Request(typeof e=="string"?new URL(e,r):e,t)}function ve(e){const t=new Set(e);function r(n,s){if(n)for(const o in n){if(o[0]==="_"||t.has(o))continue;const i=Pr(o,s?.slice(s.lastIndexOf(".")))??`valid exports are ${e.join(", ")}, or anything with a '_' prefix`;throw new Error(`Invalid export '${o}'${s?` in ${s}`:""} (${i})`)}}return r}function Pr(e,t=".js"){let r=[];if(mt.includes(e)&&r.push(`+page${t}`),_t.includes(e)&&r.push(`+page.server${t}`),wt.includes(e)&&r.push(`+server${t}`),r.length>0)return`'${e}' is a valid export in ${r.join(" or ")}`}const mt=["load","prerender","csr","ssr","trailingSlash","config"],_t=["load","prerender","csr","ssr","actions","trailingSlash","config"],wt=["GET","POST","PATCH","PUT","DELETE","OPTIONS","prerender","trailingSlash","config"],Ur=ve(mt),zr=ve(_t),Dr=ve(wt),He=({html:e})=>e,Le=()=>!1,We=({type:e})=>e==="js"||e==="css";async function gt(e,t,r,n){let s=new URL(e.url);if(t.csrf_check_origin&&e.method==="POST"&&e.headers.get("origin")!==s.origin&&Je(e)){const w=_e(403,`Cross-site ${e.method} form submissions are forbidden`);return e.headers.get("accept")==="application/json"?me(w.body,{status:w.status}):P(w.body.message,{status:w.status})}let o;try{o=Tt(s.pathname)}catch{return P("Malformed URI",{status:400})}let i=null,f={};if(T&&!n.prerendering?.fallback){if(!o.startsWith(T))return P("Not found",{status:404});o=o.slice(T.length)||"/"}const d=zt(o);let a;if(d&&(o=Ae(o)||"/",s.pathname=Ae(s.pathname)||"/",a=s.searchParams.get(Ie)?.split("_").map(Boolean),s.searchParams.delete(Ie)),!n.prerendering?.fallback){const m=await r._.matchers();for(const w of r._.routes){const $=w.pattern.exec(o);if(!$)continue;const _=jr($,w.params,m);if(_){i=w,f=qt(_);break}}}let u;const c={};let y={};const l={cookies:null,fetch:null,getClientAddress:n.getClientAddress||(()=>{throw new Error("@sveltejs/adapter-vercel does not specify getClientAddress. Please raise an issue")}),locals:{},params:f,platform:n.platform,request:e,route:{id:i?.id??null},setHeaders:m=>{for(const w in m){const $=w.toLowerCase(),_=m[w];if($==="set-cookie")throw new Error("Use `event.cookies.set(name, value, options)` instead of `event.setHeaders` to set cookies");if($ in c)throw new Error(`"${w}" header is already set`);c[$]=_,n.prerendering&&$==="cache-control"&&(n.prerendering.cache=_)}},url:s,isDataRequest:d};let h={transformPageChunk:He,filterSerializedResponseHeaders:Le,preload:We};try{if(i&&!d){if(i.page){const j=await Promise.all([...i.page.layouts.map(g=>g==null?g:r._.nodes[g]()),r._.nodes[i.page.leaf]()]);u=N(j,"trailingSlash")}else i.endpoint&&(u=(await i.endpoint()).trailingSlash);const b=be(s.pathname,u??"never");if(b!==s.pathname&&!n.prerendering?.fallback)return new Response(void 0,{status:308,headers:{"x-sveltekit-normalize":"1",location:(b.startsWith("//")?s.origin+b:b)+(s.search==="?"?"":s.search)}})}const{cookies:m,new_cookies:w,get_cookie_header:$}=vr(e,s,u??"never");y=w,l.cookies=m,l.fetch=Ar({event:l,options:t,manifest:r,state:n,get_cookie_header:$}),n.prerendering&&!n.prerendering.fallback&&Ve(s);const _=await t.hooks.handle({event:l,resolve:(b,j)=>p(b,j).then(g=>{for(const x in c){const E=c[x];g.headers.set(x,E)}return ze(g.headers,Object.values(y)),n.prerendering&&b.route.id!==null&&g.headers.set("x-sveltekit-routeid",encodeURI(b.route.id)),g})});if(_.status===200&&_.headers.has("etag")){let b=e.headers.get("if-none-match");b?.startsWith('W/"')&&(b=b.substring(2));const j=_.headers.get("etag");if(b===j){const g=new Headers({etag:j});for(const x of["cache-control","content-location","date","expires","vary","set-cookie"]){const E=_.headers.get(x);E&&g.set(x,E)}return new Response(void 0,{status:304,headers:g})}}if(d&&_.status>=300&&_.status<=308){const b=_.headers.get("location");if(b)return pe(new I(_.status,b))}return _}catch(m){if(m instanceof I){const w=d?pe(m):re(m.status,m.location);return ze(w.headers,Object.values(y)),w}return await Se(l,t,m)}async function p(m,w){try{if(w){if("ssr"in w)throw new Error("ssr has been removed, set it in the appropriate +layout.js instead. See the PR for more information: https://github.com/sveltejs/kit/pull/6197");h={transformPageChunk:w.transformPageChunk||He,filterSerializedResponseHeaders:w.filterSerializedResponseHeaders||Le,preload:w.preload||We}}if(n.prerendering?.fallback)return await Z({event:m,options:t,manifest:r,state:n,page_config:{ssr:!1,csr:!0},status:200,error:null,branch:[],fetched:[],resolve_opts:h});if(i){let $;if(d)$=await $r(m,i,t,r,n,a,u??"never");else if(i.endpoint&&(!i.page||Ct(m)))$=await Pt(m,await i.endpoint(),n);else if(i.page)$=await kr(m,i.page,t,r,n,h);else throw new Error("This should never happen");return $}return n.error?P("Internal Server Error",{status:500}):n.depth===0?await pt({event:m,options:t,manifest:r,state:n,status:404,error:new Error(`Not found: ${m.url.pathname}`),resolve_opts:h}):n.prerendering?P("not found",{status:404}):await fetch(e)}catch($){return await Se(m,t,$)}finally{m.cookies.set=()=>{throw new Error("Cannot use `cookies.set(...)` after the response has been generated")},m.setHeaders=()=>{throw new Error("Cannot use `setHeaders(...)` after the response has been generated")}}}}class Hr{#e;#t;constructor(t){this.#e=jt,this.#t=t}async init({env:t}){const r=Object.entries(t),n=this.#e.env_public_prefix;Object.fromEntries(r.filter(([o])=>!o.startsWith(n)));const s=Object.fromEntries(r.filter(([o])=>o.startsWith(n)));if(xt(s),!this.#e.hooks){const o=await vt();this.#e.hooks={handle:o.handle||(({event:i,resolve:f})=>f(i)),handleError:o.handleError||(({error:i})=>console.error(i?.stack)),handleFetch:o.handleFetch||(({request:i,fetch:f})=>f(i))}}}async respond(t,r){if(!(t instanceof Request))throw new Error("The first argument to server.respond must be a Request object. See https://github.com/sveltejs/kit/pull/3384 for details");return gt(t,this.#e,this.#t,{...r,error:!1,depth:0})}}export{Hr as Server};
